{"ast":null,"code":"var _jsxFileName = \"/Users/krmpi/PycharmProjects/FER/moonstone-CCS/client/src/components/Gantt/Gantt.js\";\nimport React, { Component } from 'react';\nimport { gantt } from 'dhtmlx-gantt';\nimport 'dhtmlx-gantt/codebase/dhtmlxgantt.css';\nimport $ from \"jquery\";\nimport { jQuery } from 'jquery';\nexport default class Gantt extends Component {\n  constructor(props) {\n    super(props);\n\n    this.showLightbox = () => {\n      this.setState({\n        showLightbox: true\n      });\n    };\n  }\n\n  componentDidMount() {\n    gantt.config.xml_date = \"%Y-%m-%d %H:%i\";\n    const {\n      tasks\n    } = this.props;\n    gantt.init(this.ganttContainer);\n    gantt.parse(tasks);\n    this.configSetup();\n    console.log(\"adding task sections\");\n\n    var fs = require('fs'); //Here we are loading the action from the action.json file\n\n\n    var actionLoaded = null;\n    var actionLabel = [];\n    var priority;\n    var data = fs.readFileSync(\"../../static/action.json\", \"utf8\");\n    $.getJSON(\"../../static/action.json\", function (json) {\n      actionLoaded = json.actions;\n      var keys = Object.keys(actionLoaded);\n      jQuery.each(keys, function (i, val) {\n        actionLabel.push({\n          \"key\": i,\n          \"label\": val\n        });\n      });\n    }); //Here we are loading the actors from the json file, this is where you should add the resources and to process data here also\n\n    var players = null;\n    var playersLabel = [];\n    $.getJSON(\"../../static/state_level_scenario.json\", function (json) {\n      players = json.players;\n      var keys = Object.keys(players);\n      var cpt = 0;\n      jQuery.each(players, function (i, val) {\n        jQuery.each(val.actors, function (y, val2) {\n          playersLabel.push({\n            \"key\": cpt,\n            \"label\": i + \".\" + val2.name\n          });\n          cpt++;\n        });\n      });\n\n      for (let r in playersLabel) {\n        $('#holder').append($('<option>', {\n          value: r,\n          text: playersLabel[r][\"label\"]\n        }));\n      }\n    }); //And here is the config.json file where all the parameters are, such as timestamp and priority for the moment\n\n    var priority = null;\n    var taskConfigText = null;\n    var jsonConfig = null; //Json configuration file in order to set all parameters\n\n    var timestamp = $.getJSON(\"../../static/config.json\", function (json) {\n      jsonConfig = json;\n      priority = json.priority;\n      taskConfigText = json.task_text;\n\n      for (let r in priority) {\n        $('#priority').append($('<option>', {\n          value: r,\n          text: priority[r]\n        }));\n      }\n\n      return json.timestamp;\n    });\n    var task_sections = [{\n      name: \"description\",\n      height: 50,\n      map_to: \"text\",\n      type: \"textarea\"\n    }, {\n      name: \"time\",\n      height: 72,\n      type: \"time\",\n      map_to: \"auto\"\n    }, {\n      name: \"holder\",\n      height: 50,\n      map_to: \"holder\",\n      type: \"select\",\n      options: playersLabel\n    }, {\n      name: \"action\",\n      height: 50,\n      type: \"select\",\n      options: actionLabel\n    }, {\n      name: \"priority\",\n      height: 50,\n      type: \"select\",\n      options: priority\n    }];\n    gantt.config.lightbox.sections = task_sections;\n    gantt.attachEvent(\"onBeforeLightbox\", function (id) {\n      var task = gantt.getTask(id);\n      gantt.config.lightbox.sections = task_sections;\n      console.log(task_sections);\n\n      if (task.$new) {\n        gantt._dhtmlx_confirm({\n          message: \"Create task?\",\n          title: \"Create task?\",\n          callback: function (res) {\n            console.log(\"res= \" + res);\n\n            if (res) {\n              //..apply values\n              delete task.$new;\n              gantt.addTask(task);\n            } else {\n              gantt.deleteTask(task.id);\n            }\n          }\n        });\n\n        return false;\n      }\n\n      return true;\n    });\n  }\n\n  render() {\n    this.setColumns();\n    const {\n      zoom\n    } = this.props;\n    this.setZoom(zoom);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      ref: input => {\n        this.ganttContainer = input;\n      },\n      style: {\n        width: '100%',\n        height: '100%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 13\n      }\n    });\n  }\n\n  setZoom(value) {\n    switch (value) {\n      case 'Hours':\n        gantt.config.scale_unit = 'day';\n        gantt.config.date_scale = '%d %M';\n        gantt.config.scale_height = 60;\n        gantt.config.min_column_width = 30;\n        gantt.config.subscales = [{\n          unit: 'hour',\n          step: 1,\n          date: '%H'\n        }];\n        break;\n\n      case 'Days':\n        gantt.config.min_column_width = 70;\n        gantt.config.scale_unit = 'week';\n        gantt.config.date_scale = '#%W';\n        gantt.config.subscales = [{\n          unit: 'day',\n          step: 1,\n          date: '%d %M'\n        }];\n        gantt.config.scale_height = 60;\n        break;\n\n      case 'Months':\n        gantt.config.min_column_width = 70;\n        gantt.config.scale_unit = 'month';\n        gantt.config.date_scale = '%F';\n        gantt.config.scale_height = 60;\n        gantt.config.subscales = [{\n          unit: 'week',\n          step: 1,\n          date: '#%W'\n        }];\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  shouldComponentUpdate(nextProps) {\n    return this.props.zoom !== nextProps.zoom;\n  }\n\n  componentDidUpdate() {\n    gantt.render();\n  }\n\n  setColumns() {\n    console.log(gantt.config.columns);\n    gantt.config.columns = [{\n      name: \"text\",\n      label: \"Task name\",\n      tree: true,\n      width: 150\n    }, {\n      name: \"start_date\",\n      label: \"Start time\",\n      align: \"center\",\n      resize: true,\n      width: 120\n    }, {\n      name: \"end_date\",\n      label: \"End date\",\n      align: \"center\",\n      resize: true,\n      width: 120\n    }, //{name:\"priority\",    height:22, type:\"select\",   map_to:\"priority\", options:priority, default_value:\"Low\"},\n    {\n      name: \"add\",\n      label: \"\",\n      width: 44\n    }];\n  }\n\n  configSetup() {\n    gantt.config.wide_form = 1;\n    gantt.config.work_time = true;\n    gantt.config.order_branch = true;\n    gantt.config.autoscroll = true;\n    gantt.config.auto_scheduling = true;\n    gantt.config.autoscroll_speed = 100;\n    gantt.config.fit_tasks = true;\n    gantt.config.scale_unit = this.props.zoom.scale_unit;\n    gantt.config.duration_unit = \"hour\";\n    gantt.config.scale_height = 50;\n    gantt.config.min_column_width = 1000;\n    gantt.config.date_scale = this.props.zoom.date_scale;\n    gantt.config.open_tree_initially = true;\n    gantt.config.subscales = this.props.zoom.subscales;\n\n    gantt.templates.timeline_cell_class = function (task, date) {\n      if (!gantt.isWorkTime({\n        task: task,\n        date: date\n      })) return \"week_end\";\n      return \"\";\n    };\n\n    gantt.setWorkTime({\n      hours: [9, 17]\n    });\n    gantt.setWorkTime({\n      day: 6,\n      hours: false\n    });\n    gantt.setWorkTime({\n      day: 7,\n      hours: false\n    });\n    gantt.locale.labels[\"milestone\"] = \"Milestone\";\n    gantt.config.buttons_left = [\"dhx_save_btn\", \"dhx_cancel_btn\", \"milestone\"];\n    gantt.config.buttons_right = [\"dhx_delete_btn\"]; //addTodayMarker();\n  }\n\n}","map":{"version":3,"sources":["/Users/krmpi/PycharmProjects/FER/moonstone-CCS/client/src/components/Gantt/Gantt.js"],"names":["React","Component","gantt","$","jQuery","Gantt","constructor","props","showLightbox","setState","componentDidMount","config","xml_date","tasks","init","ganttContainer","parse","configSetup","console","log","fs","require","actionLoaded","actionLabel","priority","data","readFileSync","getJSON","json","actions","keys","Object","each","i","val","push","players","playersLabel","cpt","actors","y","val2","name","r","append","value","text","taskConfigText","jsonConfig","timestamp","task_text","task_sections","height","map_to","type","options","lightbox","sections","attachEvent","id","task","getTask","$new","_dhtmlx_confirm","message","title","callback","res","addTask","deleteTask","render","setColumns","zoom","setZoom","input","width","scale_unit","date_scale","scale_height","min_column_width","subscales","unit","step","date","shouldComponentUpdate","nextProps","componentDidUpdate","columns","label","tree","align","resize","wide_form","work_time","order_branch","autoscroll","auto_scheduling","autoscroll_speed","fit_tasks","duration_unit","open_tree_initially","templates","timeline_cell_class","isWorkTime","setWorkTime","hours","day","locale","labels","buttons_left","buttons_right"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { gantt } from 'dhtmlx-gantt';\nimport 'dhtmlx-gantt/codebase/dhtmlxgantt.css';\nimport $ from \"jquery\";\nimport { jQuery } from 'jquery';\n\nexport default class Gantt extends Component {\n    constructor(props){\n        super(props);\n    }\n\n    componentDidMount() {\n        gantt.config.xml_date = \"%Y-%m-%d %H:%i\";\n        const { tasks } = this.props;\n        gantt.init(this.ganttContainer);\n        gantt.parse(tasks);\n        this.configSetup();\n\n        console.log(\"adding task sections\");\n\n        var fs = require('fs');\n        //Here we are loading the action from the action.json file\n  var actionLoaded = null;\n    var actionLabel = [];\n    var priority;\n\n    var data = fs.readFileSync(\"../../static/action.json\", \"utf8\");\n\n\n    $.getJSON(\"../../static/action.json\", function(json){\n      actionLoaded = json.actions;\n      var keys = Object.keys(actionLoaded);\n      jQuery.each(keys, function(i, val) {\n        actionLabel.push({\"key\": i, \"label\": val})\n      });\n    });\n\n    //Here we are loading the actors from the json file, this is where you should add the resources and to process data here also\n    var players = null;\n    var playersLabel = [];\n    $.getJSON(\"../../static/state_level_scenario.json\", function(json){\n      players  = json.players;\n      var keys = Object.keys(players);\n      var cpt = 0;\n      jQuery.each(players, function(i, val) {\n        jQuery.each(val.actors, function(y, val2) {\n          playersLabel.push({\"key\": cpt, \"label\": i + \".\" + val2.name})\n          cpt++;\n        })\n      });\n      for(let r in playersLabel){$('#holder').append($('<option>',{value: r,text: playersLabel[r][\"label\"]}))}\n    });\n\n    //And here is the config.json file where all the parameters are, such as timestamp and priority for the moment\n    var priority = null;\n    var taskConfigText = null;\n    var jsonConfig = null;\n    //Json configuration file in order to set all parameters\n    var timestamp = $.getJSON(\"../../static/config.json\", function(json){\n      jsonConfig = json;\n      priority = json.priority;\n      taskConfigText = json.task_text;\n      for(let r in priority){$('#priority').append($('<option>',{value: r,text: priority[r]}))}\n      return json.timestamp;\n    });\n\n        var task_sections = [\n            { name: \"description\", height: 50, map_to: \"text\", type: \"textarea\" },\n            { name: \"time\", height: 72, type: \"time\", map_to: \"auto\" },\n            { name: \"holder\", height: 50, map_to:\"holder\", type:\"select\",options:playersLabel},\n            { name:\"action\", height: 50, type:\"select\", options:actionLabel },\n            { name:\"priority\", height: 50, type:\"select\", options:priority }\n        ];\n\n        gantt.config.lightbox.sections = task_sections;\n\n        gantt.attachEvent(\"onBeforeLightbox\", function(id) {\n            var task = gantt.getTask(id);\n            gantt.config.lightbox.sections = task_sections;\n            console.log(task_sections);\n            if(task.$new){\n                gantt._dhtmlx_confirm({\n                    message:\"Create task?\",\n                    title:\"Create task?\",\n                    callback: function(res){\n                        console.log(\"res= \" + res);\n                        if(res){\n                            //..apply values\n                            delete task.$new;\n                            gantt.addTask(task);\n                        }else{\n                            gantt.deleteTask(task.id);\n                        }\n                    }\n                });\n                return false;\n            }\n            return true;\n        });\n    }\n\n    render() {\n        this.setColumns();\n        const { zoom } = this.props;\n        this.setZoom(zoom);\n        return (\n            <div\n                ref={(input) => { this.ganttContainer = input }}\n                style={{ width: '100%', height: '100%' }}\n            >\n            </div>\n        );\n    }\n\n    setZoom(value) {\n        switch (value) {\n            case 'Hours':\n                gantt.config.scale_unit = 'day';\n                gantt.config.date_scale = '%d %M';\n\n                gantt.config.scale_height = 60;\n                gantt.config.min_column_width = 30;\n                gantt.config.subscales = [\n                    { unit:'hour', step:1, date:'%H' }\n                ];\n            break;\n            case 'Days':\n                gantt.config.min_column_width = 70;\n                gantt.config.scale_unit = 'week';\n                gantt.config.date_scale = '#%W';\n                gantt.config.subscales = [\n                    { unit: 'day', step: 1, date: '%d %M' }\n                ];\n                gantt.config.scale_height = 60;\n            break;\n            case 'Months':\n                gantt.config.min_column_width = 70;\n                gantt.config.scale_unit = 'month';\n                gantt.config.date_scale = '%F';\n                gantt.config.scale_height = 60;\n                gantt.config.subscales = [\n                    { unit:'week', step:1, date:'#%W' }\n                ];\n            break;\n            default:\n            break;\n        }\n    }\n\n    shouldComponentUpdate(nextProps) {\n        return this.props.zoom !== nextProps.zoom;\n    }\n\n    componentDidUpdate() {\n        gantt.render();\n    }\n\n    setColumns(){\n        console.log(gantt.config.columns)\n\n        gantt.config.columns =  [\n        {name:\"text\",       label:\"Task name\",  tree:true, width: 150 },\n        {name:\"start_date\", label:\"Start time\", align:\"center\", resize: true, width: 120 },\n        {name:\"end_date\",   label:\"End date\",   align:\"center\", resize: true, width: 120 },\n        //{name:\"priority\",    height:22, type:\"select\",   map_to:\"priority\", options:priority, default_value:\"Low\"},\n        {name:\"add\",        label:\"\",           width:44 }\n    ];\n    }\n\n    configSetup() {\n      gantt.config.wide_form = 1;\n      gantt.config.work_time = true;\n      gantt.config.order_branch = true;\n      gantt.config.autoscroll = true;\n      gantt.config.auto_scheduling = true;\n      gantt.config.autoscroll_speed = 100;\n      gantt.config.fit_tasks = true;\n      gantt.config.scale_unit = this.props.zoom.scale_unit;\n      gantt.config.duration_unit = \"hour\";\n      gantt.config.scale_height = 50;\n      gantt.config.min_column_width = 1000;\n      gantt.config.date_scale = this.props.zoom.date_scale;\n      gantt.config.open_tree_initially = true;\n      gantt.config.subscales = this.props.zoom.subscales;\n      gantt.templates.timeline_cell_class = function(task, date){\n        if(!gantt.isWorkTime({task:task, date: date}))\n          return \"week_end\";\n        return \"\";\n      };\n      gantt.setWorkTime({\n        hours: [9,17]\n      })\n      gantt.setWorkTime({ day:6, hours:false });\n      gantt.setWorkTime({ day:7, hours:false });\n      gantt.locale.labels[\"milestone\"] = \"Milestone\";\n      gantt.config.buttons_left = [\"dhx_save_btn\", \"dhx_cancel_btn\", \"milestone\"];\n      gantt.config.buttons_right = [\"dhx_delete_btn\"];\n      //addTodayMarker();\n    }\n\n    showLightbox = () => {\n        this.setState({ showLightbox: true });\n    }\n}"]},"metadata":{},"sourceType":"module"}